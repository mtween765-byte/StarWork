<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Telegram Mini App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      text-align: center;
      padding: 40px;
    }
    button {
      padding: 12px 20px;
      font-size: 16px;
      background: #22c55e;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <h1>StarWork Mini App üöÄ</h1>
  <p id="user"></p>

  <button onclick="showUser()">–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    function showUser() {
      if (tg.initDataUnsafe.user) {
        document.getElementById("user").innerText =
          "–ü—Ä–∏–≤–µ—Ç, " + tg.initDataUnsafe.user.first_name;
      } else {
        document.getElementById("user").innerText =
          "–û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ Telegram";
      }
    }
  </script>

</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>StarWork Mini App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#0f172a; color:white; margin:0; padding:0; }
    header { background:#111827; padding:15px; text-align:center; font-size:20px; font-weight:bold; }
    nav { display:flex; justify-content:space-around; background:#1f2937; padding:10px 0; }
    nav button { background:#2563eb; border:none; padding:10px 20px; border-radius:6px; color:white; cursor:pointer; }
    .tab { display:none; padding:20px; }
    input, textarea { width:100%; padding:8px; margin:5px 0; border-radius:4px; border:none; }
    button.action { background:#22c55e; margin-top:10px; width:100%; }
    .task { border:1px solid #334155; padding:10px; margin:10px 0; border-radius:6px; }
  </style>
</head>
<body>

<header>StarWork Mini App üöÄ</header>

<nav>
  <button onclick="showTab('tasks')">–ó–∞–¥–∞–Ω–∏—è</button>
  <button onclick="showTab('history')">–ò—Å—Ç–æ—Ä–∏—è</button>
  <button onclick="showTab('wallet')">–ö–æ—à–µ–ª–µ–∫</button>
  <button onclick="showTab('profile')">–ü—Ä–æ—Ñ–∏–ª—å</button>
</nav>

<!-- –ó–∞–¥–∞–Ω–∏—è -->
<div id="tasks" class="tab"></div>

<!-- –ò—Å—Ç–æ—Ä–∏—è -->
<div id="history" class="tab"></div>

<!-- –ö–æ—à–µ–ª–µ–∫ -->
<div id="wallet" class="tab"></div>

<!-- –ü—Ä–æ—Ñ–∏–ª—å -->
<div id="profile" class="tab"></div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

let user = tg.initDataUnsafe.user || { id:0, first_name:"–ì–æ—Å—Ç—å" };
const ADMIN_ID = 6320615361;

let balance = { ton: 1.0, stars: 50 }; // —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
let tasks = [
  { id:1, title:"–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ", description:"–û–ø–∏—Å–∞–Ω–∏–µ 1", report_req:"–°–∫—Ä–∏–Ω—à–æ—Ç", reward_type:"TON", reward_amount:0.5, type:"ONE", active:true },
  { id:2, title:"–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ", description:"–û–ø–∏—Å–∞–Ω–∏–µ 2", report_req:"–°—Å—ã–ª–∫–∞", reward_type:"STARS", reward_amount:20, type:"MULTI", interval_hours:24, active:true }
];
let history = [];

// –≤–∫–ª–∞–¥–∫–∏
function showTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.style.display='none');
  document.getElementById(tab).style.display='block';
  if(tab==='tasks') renderTasks();
  if(tab==='history') renderHistory();
  if(tab==='wallet') renderWallet();
  if(tab==='profile') renderProfile();
}

// –∑–∞–¥–∞—á–∏
function renderTasks(){
  let container = document.getElementById('tasks');
  container.innerHTML = '';
  
  // –µ—Å–ª–∏ –∞–¥–º–∏–Ω
  if(user.id===ADMIN_ID){
    let form = document.createElement('div');
    form.innerHTML=`
      <h3>–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ (–ê–¥–º–∏–Ω)</h3>
      <input id="task_title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"/>
      <textarea id="task_desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è"></textarea>
      <input id="task_report" placeholder="–ß—Ç–æ —É–∫–∞–∑–∞—Ç—å –≤ –æ—Ç—á–µ—Ç–µ"/>
      <select id="task_reward_type"><option>TON</option><option>STARS</option></select>
      <input id="task_reward_amount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ"/>
      <select id="task_type"><option value="ONE">–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ</option><option value="MULTI">–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–æ–µ</option></select>
      <input id="task_interval" placeholder="–ò–Ω—Ç–µ—Ä–≤–∞–ª —á–∞—Å–æ–≤ (–¥–ª—è –º–Ω–æ–≥–æ—Ä–∞–∑–æ–≤—ã—Ö)"/>
      <button class="action" onclick="createTask()">–°–æ–∑–¥–∞—Ç—å</button>
    `;
    container.appendChild(form);
  }

  tasks.filter(t=>t.active).forEach(t=>{
    let div = document.createElement('div');
    div.className='task';
    div.innerHTML=`
      <b>${t.title}</b> [${t.type==='ONE'?'–û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ':'–ú–Ω–æ–≥–æ—Ä–∞–∑–æ–≤–æ–µ'}]<br>
      ${t.description}<br>
      –ù–∞–≥—Ä–∞–¥–∞: ${t.reward_amount} ${t.reward_type}<br>
      <button onclick="submitTask(${t.id})">–í—ã–ø–æ–ª–Ω–∏—Ç—å</button>
    `;
    container.appendChild(div);
  });
}

// —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ (–∞–¥–º–∏–Ω)
function createTask(){
  let title = document.getElementById('task_title').value;
  let desc = document.getElementById('task_desc').value;
  let report = document.getElementById('task_report').value;
  let reward_type = document.getElementById('task_reward_type').value;
  let reward_amount = parseFloat(document.getElementById('task_reward_amount').value);
  let type = document.getElementById('task_type').value;
  let interval = parseInt(document.getElementById('task_interval').value);
  
  let id = tasks.length+1;
  tasks.push({ id,title,description:desc,report_req:report,reward_type,reward_amount,type,interval_hours:interval,active:true });
  alert('–ó–∞–¥–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!');
  renderTasks();
}

// –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
function submitTask(taskId){
  let t = tasks.find(x=>x.id===taskId);
  if(!t) return;
  let report = prompt(`–û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ—Ç—á–µ—Ç –¥–ª—è "${t.title}" (${t.report_req})`);
  if(!report) return;
  history.push({ task:t.title, status:'–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ', reward:t.reward_amount, reward_type:t.reward_type });
  if(t.type==='ONE') t.active=false;
  alert('–ó–∞–¥–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É');
  renderTasks();
}

// –∏—Å—Ç–æ—Ä–∏—è
function renderHistory(){
  let container = document.getElementById('history');
  container.innerHTML='';
  history.forEach(h=>{
    let div = document.createElement('div');
    div.className='task';
    div.innerHTML=`<b>${h.task}</b> ‚Äî ${h.status} ‚Äî –ù–∞–≥—Ä–∞–¥–∞: ${h.reward} ${h.reward_type}`;
    container.appendChild(div);
  });
}

// –∫–æ—à–µ–ª–µ–∫
function renderWallet(){
  let container = document.getElementById('wallet');
  container.innerHTML=`
    <h3>–ë–∞–ª–∞–Ω—Å</h3>
    TON: ${balance.ton}<br>
    Stars: ${balance.stars}<br><br>
    <button onclick="withdraw('TON')">–í—ã–≤–µ—Å—Ç–∏ TON</button>
    <button onclick="withdraw('STARS')">–í—ã–≤–µ—Å—Ç–∏ Stars</button>
  `;
}

function withdraw(type){
  let min = type==='TON'?0.25:15;
  let amount = parseFloat(prompt(`–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –≤—ã–≤–æ–¥–∞ ${type} (–º–∏–Ω ${min})`));
  if(isNaN(amount) || amount<min){ alert('–°—É–º–º–∞ —Å–ª–∏—à–∫–æ–º –º–∞–ª–∞'); return; }
  let wallet = prompt('–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ (–¥–ª—è TON) –∏–ª–∏ –Ω–∏–∫ (–¥–ª—è Stars)');
  alert(`${type} ${amount} –∑–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –≤—ã–≤–æ–¥!`);
}

// –ø—Ä–æ—Ñ–∏–ª—å
function renderProfile(){
  let container = document.getElementById('profile');
  container.innerHTML=`
    Telegram: ${user.first_name} <br>
    ID: ${user.id} <br><br>
    <h4>–£—Å–ª–æ–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</h4>
    –ê–¥–º–∏–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –æ—Ç–∫–ª–æ–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è, –∏–∑–º–µ–Ω—è—Ç—å –Ω–∞–≥—Ä–∞–¥—ã –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª. <br><br>
    ${user.id===ADMIN_ID?'–í—ã –∞–¥–º–∏–Ω –∏ –≤–∏–¥–∏—Ç–µ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è':'–í—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}
  `;
}

// –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
showTab('tasks');
</script>

</body>
</html>
